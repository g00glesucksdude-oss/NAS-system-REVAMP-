<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>House‚ÄëHold Archive & Streams</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {font-family:sans-serif;background:#f4f4f9;margin:0;padding-top:20px;text-align:center;}
  .tab-container {display:flex;justify-content:center;margin-bottom:15px;
    position:sticky;top:0;background:#fff;padding:8px;z-index:1000;
    box-shadow:0 2px 5px rgba(0,0,0,0.1);}
  .tab-btn{padding:8px 20px;border:none;background:#ddd;border-radius:5px;
    font-weight:bold;margin:0 3px;cursor:pointer;}
  .tab-btn.active{background:#007bff;color:#fff;}
  .content-section{display:none;padding:15px;}
  .content-section.active{display:block;}
  .title{color:#007bff;font-size:clamp(24px,5vw,36px);margin:5px;}
  .peer-count{color:green;font-weight:bold;}
  .progress-item{margin:10px auto;padding:10px;background:#fff;
    border-radius:5px;max-width:600px;box-shadow:0 1px 3px rgba(0,0,0,0.1);}
  .progress-bar-bg{width:100%;border:1px solid #666;height:18px;
    border-radius:8px;background:#eee;margin-top:4px;overflow:hidden;}
  .bar{height:100%;width:0%;background:green;transition:width .1s;}
  #chatBox{width:95%;max-width:600px;margin:15px auto;padding:8px;height:250px;
    overflow-y:auto;background:#fafafa;border:1px solid #ccc;border-radius:5px;}
  #files .file-item,
  #streamFiles .file-item{margin:8px auto;padding:10px;background:#fff;
    border-radius:5px;max-width:600px;display:flex;justify-content:space-between;
    align-items:center;border:1px solid #ddd;}
  .file-info{text-align:left;}
  .file-name{font-weight:bold;}
  .file-meta{font-size:12px;color:#666;}
  button{padding:6px 12px;border:none;border-radius:4px;cursor:pointer;
    font-weight:bold;margin:2px;}
  .btn-blue{background:#007bff;color:#fff;}
  .btn-red{background:#dc3545;color:#fff;}
  .btn-green{background:#28a745;color:#fff;}
  .search-input{width:70%;max-width:600px;padding:6px;border:1px solid #bbb;
    border-radius:4px;margin:8px auto;}
  .overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);
    display:flex;justify-content:center;align-items:center;z-index:2000;}
  .overlay.hidden{display:none;}
  .modal{background:#fff;padding:20px;border-radius:8px;text-align:center;
    min-width:300px;box-shadow:0 2px 8px rgba(0,0,0,0.3);}
  #driveStatus{margin:8px;color:#d00;font-weight:bold;}
  #breadcrumb{margin:8px 0;font-size:0.9em;color:#555;}
</style>
</head>
<body>

<div class="overlay hidden" id="pwdOverlay">
  <div class="modal">
    <h2>Enter password for room ‚Äú<span id="roomDisplay"></span>‚Äù</h2>
    <input id="pwdInputModal" type="password" placeholder="Password"/>
    <div id="pwdError" style="color:red;margin-top:5px;"></div>
    <button id="pwdSubmit" class="btn-blue" style="margin-top:10px;">Enter</button>
  </div>
</div>

<div class="tab-container">
  <button class="tab-btn active" onclick="showTab('archiveTab',this)">üìÅ ARCHIVE</button>
  <button class="tab-btn" onclick="showTab('streamsTab',this)">üì∫ STREAMS</button>
</div>

<!-- ==================== ARCHIVE TAB ==================== -->
<div id="archiveTab" class="content-section active">
  <h1 class="title">House‚ÄëHold Archive</h1>
  <div>
    Room: <span id="roomName"></span>
    <button id="leaveBtn" class="btn-red" onclick="leaveRoom()">Leave room</button>
    | Peers: <span class="peer-count" id="archivePeerCount">0</span>
  </div>

  <input class="search-input" id="searchInput" placeholder="Search archived files‚Ä¶" autocomplete="off">
  <div style="margin:15px;">
    <input type="file" id="fileInput" multiple>
  </div>
  <div id="progressArea"></div>
  <div id="files"></div>

  <hr>
  <h3>Room Chat</h3>
  <input id="usernameInput" placeholder="Your name"/>
  <button class="btn-green" onclick="changeUsername()">Change Name</button>
  <span id="currentUser"></span>
  <div id="chatBox"></div>
  <input id="msgInput" placeholder="Type a message‚Ä¶" style="width:70%;padding:6px;"
         onkeypress="if(event.key==='Enter'){sendMessage();}">
  <button id="sendBtn" class="btn-blue" onclick="sendMessage()">Send</button>
</div>

<!-- ==================== STREAMS TAB ==================== -->
<div id="streamsTab" class="content-section">
  <h1 class="title">üì∫ Server Streams</h1>

  <div class="drive-selector">
    <select id="driveSelect" onchange="driveChanged()"></select>
    <div id="driveStatus" class="hidden"></div>
    <div style="margin-top:8px;">Peers: <span class="peer-count" id="streamPeerCount">0</span></div>
  </div>

  <!-- breadcrumb (Home / folder / sub‚Äëfolder) -->
  <div id="breadcrumb"></div>

  <input class="search-input" id="streamSearch" placeholder="Search stream files‚Ä¶" autocomplete="off">

  <div id="streamFiles"></div>
</div>

<!-- Simple‚ÄëPeer library (still loaded from CDN) -->
<script src="https://unpkg.com/simple-peer@9.11.1/simplepeer.min.js"></script>
<!-- UI logic (separate file) -->
<script src="app.js"></script>
</body>
</html>
